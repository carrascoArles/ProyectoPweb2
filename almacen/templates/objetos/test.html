{% extends 'tienda.html' %}

{% block content%}
<select id = "opcion"  class = "" onchange="obtenerSelect(this)">
    <option class = "" onclick="">Todos</button>
    {% for obj in productos %}
        <option class = "" onclick="">{{ obj.categoria }}</button>
    {% endfor %}  
</select>
<div id = "productos">
    {% for obj in productos %}
        <h1>Nombre: {{ obj.nombre }}</h1>
        <img src='{{ obj.imagen }}' width = "350" height = "300" alt = '{{ obj.nombre }}'>
        <h2>{{ obj.descripcion }}</h2>
        <h2>Stock: {{ obj.stock }}</h2>
        <h1>Precio: S/.{{ obj.precio }}</h1>
    {% endfor %}
</div>

<script>
    function obtenerSelect(selectElement) {
        var selected = selectElement.options[selectElement.selectedIndex].text;
        console.log(selected);

        // Enviamos una peticion AJAX al servidor
        var xhr = new XMLHttpRequest();
        xhr.open('GET', 'obtener_productos/?categoria/=' + selected, true);
        xhr.onreadystatechange = function() { // por cambio...
            if (xhr.readyState === 4 && xhr.status === 200) {// si hay buena respuesta del servidor
                var response = xhr.responseText;
                document.getElementById('productos').innerHTML = response;
            }
        };
        xhr.send();
        
    }
</script>
{%endblock%}
